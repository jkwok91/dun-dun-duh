<!doctype html>
<html>
	<head>
		<title>Crop on Face</title>
		<script src="{{ url_for("static", filename="jcrop/js/jquery.min.js") }}"></script>
		<script src="{{ url_for("static", filename="jcrop/js/jquery.Jcrop.min.js") }}"></script>
		<link rel="stylesheet" href="{{ url_for("static", filename="jcrop/css/jquery.Jcrop.css") }}" type="text/css" />
	</head>
	<body>
		<h1>Crop on Face</h1>
		<img src="{{ url_for("uploaded_file", filename=filename) }}" alt="Loading..." id="base-image" />
		<form method="POST" action="{{ url_for("compose", filename=filename) }}">
			<input type="hidden" name="x" value="{{ x }}" />
			<input type="hidden" name="y" value="{{ y }}" />
			<input type="hidden" name="size" value="{{ size }}" />
			<button type="submit" disabled="disabled">Create My Gif</button>
		</form>
		<script>
			$(function () {
				$('#base-image').Jcrop({
					aspectRatio: 1,
					minSize: [10, 10],
					maxSize: [{{ max_size }}, {{ max_size }}],
					allowSelect: false,
					setSelect: [{{ x }}, {{ y }}, {{ x + size }}, {{ y + size }}],
					onSelect: function (c) {
						$('input[name=x]').val(c.x);
						$('input[name=y]').val(c.y);
						$('input[name=size]').val(c.w);
						$('button').attr('disabled', false);
					}
				});
			});
		</script>
	</body>
</html>
